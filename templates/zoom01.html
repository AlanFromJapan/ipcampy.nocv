{% extends 'master01.html' %}

{% block contents %} 
<a href="/">[Back to cameras list]</a><br/>
<br/>
<div class="showcamera">
<p class="camname">{{ cam.nickname }}</p>
<img name="capture" id="{{ cam.nickname }}" src="/{{ cam.nickname }}/capture.jpg?highRes=true&dummy" width="100%"/><span id="spanBlinker"></span> <br/>
</div>
<br/>
<br/>

<input type="range" min="3" max="60" value="3" class="slider" id="sliderUpdateinSec" />&nbsp;<span id="spanSlider">3</span> second(s) interval.


<script type="text/javascript">
  //AUTOREFRESH https://stackoverflow.com/questions/20877813/auto-refresh-images-in-html
window.onload = function() {
  // Update the current slider value (each time you drag the slider handle)
  document.getElementById("sliderUpdateinSec").oninput = function() {
    document.getElementById("spanSlider").innerHTML = this.value;
  } 

  //AUTOREFRESH
      function updateImage() {

          var slider = document.getElementById("sliderUpdateinSec");
          clearInterval(refreshtimer);
          refreshtimer = setInterval(updateImage, 1000 * slider.value);

          var captureS = document.getElementsByName("capture");
          for (let i = 0; i < captureS.length; i++) {
            //the "?time" is unnecessary but forces a refresh of the image (GET params ignored for this function)
            cap = captureS[i];
            cap.src = "/" + cap.id + "/capture.jpg?highRes=true&" + new Date().getTime();

          }
      }

      var refreshtimer = setInterval(updateImage, 3000);
  
}

</script>
{% endblock %}